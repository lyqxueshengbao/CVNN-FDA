# FDA-MIMO é›·è¾¾å‚æ•°ä¼°è®¡ - CVNN å®ç°

åŸºäº**å¤æ•°å€¼ç¥ç»ç½‘ç»œ (Complex-Valued Neural Network, CVNN)** çš„ FDA-MIMO é›·è¾¾è·ç¦»-è§’åº¦è”åˆä¼°è®¡ç³»ç»Ÿã€‚

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†åŸºäº FDA-MIMO é›·è¾¾çš„è·ç¦»-è§’åº¦è”åˆä¼°è®¡ï¼Œä½¿ç”¨**æ·±åº¦å¤æ•°ç¥ç»ç½‘ç»œ**ç›´æ¥ä»å¤æ•°åæ–¹å·®çŸ©é˜µä¸­ä¼°è®¡ç›®æ ‡å‚æ•°ã€‚

### æ ¸å¿ƒåˆ›æ–°

- âœ… **å¤æ•°åŸŸæ·±åº¦å­¦ä¹ **: ä¿ç•™ä¿¡å·çš„ç›¸ä½ä¿¡æ¯ï¼Œç›¸æ¯”å®å€¼CNNæ›´èƒ½æ•è·å¤æ•°æ•°æ®ç‰¹å¾
- âœ… **æ”¹è¿›çš„ModReLUæ¿€æ´»**: ä¿®å¤äº†ä¼ ç»ŸModReLUçš„åç½®é—®é¢˜
- âœ… **ç«¯åˆ°ç«¯å­¦ä¹ **: ä»åæ–¹å·®çŸ©é˜µç›´æ¥å›å½’åˆ° (è·ç¦», è§’åº¦)

### æ€§èƒ½æŒ‡æ ‡

åœ¨ 10000 æ ·æœ¬ã€50 epochs è®­ç»ƒåï¼š
- **RMSE_r â‰ˆ 32m** (è·ç¦»ä¼°è®¡)
- **RMSE_Î¸ â‰ˆ 1.7Â°** (è§’åº¦ä¼°è®¡)
- ç›¸æ¯”éšæœºçŒœæµ‹æå‡çº¦ **95%**

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
CVNN-FDA/
â”œâ”€â”€ config.py              # é…ç½®å‚æ•° (ç‰©ç†å‚æ•°ã€è®­ç»ƒå‚æ•°)
â”œâ”€â”€ utils.py               # å·¥å…·å‡½æ•° (å¯¼å‘çŸ¢é‡ç”Ÿæˆã€ä¿¡å·åˆæˆ)
â”œâ”€â”€ complex_layers.py      # å¤æ•°ç¥ç»ç½‘ç»œå±‚ (ComplexConv2d, ComplexBatchNorm ç­‰)
â”œâ”€â”€ dataset.py             # æ•°æ®é›† (åŠ¨æ€ç”Ÿæˆ FDA-MIMO å›æ³¢æ•°æ®)
â”œâ”€â”€ model.py               # CVNN æ¨¡å‹æ¶æ„ (CVNN_Improved)
â”œâ”€â”€ train.py               # è®­ç»ƒæ¨¡å— (Trainer ç±»ã€æŸå¤±å‡½æ•°)
â”œâ”€â”€ evaluate.py            # è¯„ä¼°å’Œå¯è§†åŒ–æ¨¡å—
â”œâ”€â”€ main.py                # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt       # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ README.md              # æœ¬æ–‡ä»¶
â”œâ”€â”€ checkpoints/           # æ¨¡å‹æ£€æŸ¥ç‚¹
â”œâ”€â”€ results/               # è®­ç»ƒç»“æœå’Œå›¾è¡¨
â””â”€â”€ archive/               # å†å²è°ƒè¯•å’Œå®éªŒæ–‡ä»¶
    â”œâ”€â”€ debug/             # è°ƒè¯•è„šæœ¬
    â”œâ”€â”€ test/              # å•å…ƒæµ‹è¯•
    â””â”€â”€ experiments/       # å®éªŒä»£ç 
```

## ğŸ”§ ç¯å¢ƒé…ç½®

### ä¾èµ–è¦æ±‚

- Python >= 3.8
- PyTorch >= 1.10.0 (æ”¯æŒå¤æ•°è¿ç®—)
- NumPy
- Matplotlib
- tqdm

### å®‰è£…

```bash
pip install -r requirements.txt
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è®­ç»ƒæ¨¡å‹

```bash
# ä½¿ç”¨é»˜è®¤CVNNæ¨¡å‹è®­ç»ƒ
python main.py --mode train

# æŒ‡å®šè®­ç»ƒå‚æ•°
python main.py --mode train --model cvnn --epochs 100 --train_size 20000

# ä½¿ç”¨å®å€¼CNNä½œä¸ºå¯¹æ¯”
python main.py --mode train --model real_cnn
```

### è¯„ä¼°æ¨¡å‹

```bash
# è¯„ä¼°å·²è®­ç»ƒçš„æ¨¡å‹
python main.py --mode evaluate --model_path ./checkpoints/best_model.pth
```

### å®Œæ•´æµç¨‹

```bash
# è®­ç»ƒ + è¯„ä¼°
python main.py --mode all
```

## ğŸ“Š æŠ€æœ¯ç»†èŠ‚

### ç‰©ç†æ¨¡å‹å‚æ•°

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| M | 10 | å‘å°„é˜µå…ƒæ•° |
| N | 10 | æ¥æ”¶é˜µå…ƒæ•° |
| fâ‚€ | 1 GHz | è½½æ³¢é¢‘ç‡ |
| Î”f | 30 kHz | é¢‘ç‡åç§» |
| L | 500 | å¿«æ‹æ•° |
| r | [0, 2000] m | è·ç¦»èŒƒå›´ |
| Î¸ | [-60Â°, 60Â°] | è§’åº¦èŒƒå›´ |

### ç½‘ç»œç»“æ„ (CVNN_Improved)

```
è¾“å…¥: (batch, 1, 100, 100) complex
    â†“
Block 1: ComplexConv(1â†’32) + BN + ModReLU Ã— 2 + Pool
    â†“
Block 2: ComplexConv(32â†’64) + BN + ModReLU Ã— 2 + Pool
    â†“
Block 3: ComplexConv(64â†’128) + BN + ModReLU + GAP
    â†“
è¾“å‡ºå±‚: Flatten + cat[real,imag] + FC(256â†’64â†’2) + Sigmoid
    â†“
è¾“å‡º: (batch, 2) [r_norm, Î¸_norm]
```

### å…³é”®æ”¹è¿›

1. **ModReLUåç½®**: åˆå§‹åŒ–ä¸º0è€Œéæ­£æ•°ï¼Œé¿å…ReLU(|z|+b)æ’ä¸ºæ­£
2. **æ± åŒ–å¤„ç†**: åˆ†ç¦»å®éƒ¨è™šéƒ¨æ± åŒ– `torch.complex(pool(x.real), pool(x.imag))`
3. **è¾“å‡ºå±‚**: æ‹¼æ¥å®éƒ¨è™šéƒ¨åä½¿ç”¨å®å€¼å…¨è¿æ¥å±‚

## ğŸ“ˆ å¯ç”¨æ¨¡å‹

| æ¨¡å‹å | è¯´æ˜ | å‚æ•°é‡ |
|--------|------|--------|
| `cvnn` / `cvnn_improved` | æ”¹è¿›çš„CVNN (æ¨è) | ~296K |
| `real` / `real_cnn` | å®å€¼CNNåŸºçº¿ | ~102K |

## ğŸ“ å½’æ¡£æ–‡ä»¶è¯´æ˜

`archive/` æ–‡ä»¶å¤¹åŒ…å«å¼€å‘è¿‡ç¨‹ä¸­çš„è°ƒè¯•å’Œå®éªŒä»£ç ï¼š

- `debug/` - è¯Šæ–­è„šæœ¬ã€è°ƒè¯•è¾“å‡º
- `test/` - å„ç§å•å…ƒæµ‹è¯•
- `experiments/` - å®éªŒæ€§æ¨¡å‹ (beamspaceã€FFTæ˜ å°„ç­‰)
- `model_backup.py` - å®Œæ•´çš„æ—§ç‰ˆmodel.pyå¤‡ä»½

## ğŸ“ License

MIT License
